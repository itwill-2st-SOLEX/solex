<th:block xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:fragment="header">
	<div class="costom-inner">
		<nav class="costom-nav layout-navbar container-xxl navbar-detached navbar navbar-expand-xl align-items-center bg-navbar-theme"
			id="layout-navbar">
			<div class="layout-menu-toggle navbar-nav align-items-xl-center me-4 me-xl-0 d-xl-none">
				<a class="nav-item nav-link px-0 me-xl-6" href="javascript:void(0)">
					<i class="icon-base bx bx-menu icon-md"></i>
				</a>
			</div>

			<div class="navbar-nav-right d-flex align-items-center justify-content-end" id="navbar-collapse">
				<!-- Search -->
				<div class="navbar-nav align-items-center me-auto">
					<div class="nav-item d-flex align-items-center">
						<span class="w-px-22 h-px-22"><i class="icon-base bx bx-search icon-md"></i></span>
						<input type="text" class="form-control border-0 shadow-none ps-1 ps-sm-2 d-md-block d-none"
							placeholder="Search..." aria-label="Search..." />
					</div>
				</div>
				<!-- /Search -->

				<ul class="navbar-nav flex-row align-items-center ms-md-auto">
					<!-- 메신저 -->
					<li class="me-4">
						<a class="dropdown-item" href="#" onclick="openMessengerPopup(event)">
							<span class="d-flex align-items-center align-middle position-relative">
								<i class="menu-icon tf-icons bx bx-message-rounded" style="font-size: 1.6rem;"></i>
<!--								<span id="header-chat-badge" class="badgerounded-pill bg-danger position-absolute"-->
<!--									style="font-size: 0.6rem; min-width: 1rem; height: 1rem;-->
<!--					                   top: 75%; right: 56px; transform: translate(50%, -50%);"> -->
<!--								</span>-->

								<span class="flex-grow-1 align-middle ms-2">메신저</span>
							</span>
						</a>
					</li>
					</span>
					</a>
					</li>

					<!-- User -->
					<li class="nav-item navbar-dropdown dropdown-user dropdown">
						<a class="nav-link dropdown-toggle hide-arrow p-0" href="javascript:void(0);"
							data-bs-toggle="dropdown">
							<div class="avatar avatar-online">
								<img th:src="@{/assets/img/avatars/1.png}" alt class="w-px-40 h-auto rounded-circle" />
							</div>
						</a>
						<ul class="dropdown-menu dropdown-menu-end">
							<li>
								<a class="dropdown-item" href="#">
									<div class="d-flex">
										<div class="flex-shrink-0 me-3">
											<div class="avatar avatar-online">
												<img th:src="@{/assets/img/avatars/1.png}" alt
													class="w-px-40 h-auto rounded-circle" />
											</div>
										</div>
										<div class="flex-grow-1">
											<h6 class="mb-0">John Doe</h6>
											<small class="text-body-secondary">Admin</small>
										</div>
									</div>
								</a>
							</li>
							<li>
								<div class="dropdown-divider my-1"></div>
							</li>
							<li>
								<a class="dropdown-item" href="#">
									<i class="icon-base bx bx-user icon-md me-3"></i><span>My Profile</span>
								</a>
							</li>
							<li>
								<a class="dropdown-item" href="#">
									<i class="icon-base bx bx-cog icon-md me-3"></i><span>Settings</span>
								</a>
							</li>
							<li>
								<div class="dropdown-divider my-1"></div>
							</li>
							<li>
								<a href="#" class="dropdown-item"
									onclick="event.preventDefault(); document.getElementById('logoutForm').submit();">
									<i class="icon-base bx bx-power-off icon-md me-3"></i><span>로그아웃</span>
								</a>
							</li>
							<form id="logoutForm" action="/SOLEX/logout" method="post" style="display:none;"></form>
						</ul>
					</li>
					<!--/ User -->
				</ul>
			</div>
		</nav>
	</div>
	<script>
		function openMessengerPopup(event) {
			event.preventDefault();
			const popup = window.open('/SOLEX/chats', 'MessengerWindow', 'width=500,height=700,left=100,top=100');
			if (!popup || popup.closed) {
				alert('팝업 차단 해제해주세요!');
			} else {
				popup.focus();
			}
		}
		/*
		document.addEventListener('DOMContentLoaded', function () {
		    // chat.js가 먼저 로드되어서 unreadCnt 함수가 정의되어 있어야 함
		    if (typeof unreadCnt === 'function') {
		      unreadCnt();
		    } else {
		      console.warn('unreadCnt 함수가 정의되어 있지 않습니다.');
		    }
		  });
		  */
	</script>
</th:block>